# プロダクトコンテキスト (Product Context)

_このドキュメントは、プロジェクトが存在する理由、解決しようとしている問題、期待される動作、およびユーザー体験の目標を定義します。`projectbrief.md` に基づいています。_

## 1. 背景と課題

医療機関において、入院EF統合ファイルから短期滞在手術等基本料３（短手３）の対象症例を特定する作業は、手作業では時間と手間がかかり、誤りが発生する可能性もある。特に複数月のデータを扱う場合や、退院日が未確定の症例を追跡する場合に複雑さが増す。このツールは、この抽出作業を自動化し、効率化・正確化することで、医療機関の負担を軽減し、適切な診療報酬請求を支援する必要性から生まれた。

## 2. プロダクトのビジョン

医療機関の担当者が、特別なITスキルなしに、簡単かつ迅速に短手３対象症例を特定できる、信頼性の高いデスクトップツールとなることを目指す。将来的には、他の診療報酬項目の判定支援など、機能拡張の可能性も視野に入れるが、まずは短手３判定のコア機能を確実なものとする。

## 3. ターゲットユーザー

- **主要ユーザー:** 医療機関の診療報酬請求担当者、医事課職員など。
- **ユーザーの特徴:** 必ずしも高いITリテラシーを持つとは限らない。日常業務でEF統合ファイルを扱っている。正確かつ効率的な作業を求めている。

## 4. 主要な機能とユーザーフロー

1.  **ファイル選択:** ユーザーはローカルPCから入院EF統合ファイル（単一または複数月）を選択する（ファイル選択ダイアログ or ドラッグ＆ドロップ）。
2.  **設定:** ユーザーは出力オプション（全症例/対象症例のみ、日付フォーマット）を選択する。
3.  **実行:** ユーザーは「判定開始」ボタンをクリックする。
4.  **処理:**
    - ツールは選択されたファイルを読み込み、検証（必須項目、形式、列数など）を行う。
    - 検証結果（エラー/警告）があればユーザーに通知する。
    - 検証をパスしたデータに対し、短手３判定ロジックを実行する。
    - 複数月のファイルがある場合、月をまたぐ症例や退院日更新を考慮して処理する。
5.  **結果表示:** 判定結果を設定に基づいてフィルタリング・フォーマットし、画面上のテキストエリアに表示する。
6.  **出力/コピー:** ユーザーは表示された結果をテキストファイルとしてダウンロードするか、クリップボードにコピーする。
7.  **クリア:** ユーザーは「クリア」ボタンでファイル選択や結果表示をリセットできる。

## 5. ユーザー体験 (UX) の目標

- **シンプルさ:** 専門知識がなくても直感的に操作できるシンプルなインターフェース。
- **効率性:** ファイル選択から結果取得までのステップを最小限にし、迅速な処理を実現する。
- **明確性:** 判定結果やエラー/警告メッセージが分かりやすく、ユーザーが状況を容易に把握できる。
- **信頼性:** 正確な判定ロジックと堅牢なバリデーションにより、信頼できる結果を提供する。
- **手軽さ:** インストール不要で、HTMLファイルをブラウザで開くだけで利用できる手軽さを提供する。

## 6. 非機能要件（UX 関連）

- **パフォーマンス:** 大量のファイルやデータを処理する場合でも、フリーズすることなく、妥当な時間内に処理を完了する。（現状、具体的な目標値は未設定）
- **アクセシビリティ:** キーボード操作のみでの利用が可能であること、スクリーンリーダーでの読み上げに対応することなど、基本的なアクセシビリティ要件を満たす。（WCAG準拠を意識）
- **互換性:** 主要なモダンブラウザ（Chrome, Edge）の最新版で正常に動作すること。
- **安全性:** データはローカルPC内でのみ処理され、外部に送信・保存されないこと。
- **堅牢性:** 不正な形式のファイルや予期せぬデータに対しても、エラーメッセージを表示し、プログラムがクラッシュしないこと。
- **保守性:** コードが整理されており、将来的な機能追加や修正が容易であること。
